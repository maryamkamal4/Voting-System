{% extends 'dashboard.html' %}
{% block dashboard_name %}
    <h2>Admin Dashboard</h2>
{% endblock %}

{% block sidebar %}
<div class="list-group list-group-flush">
    <a class="list-group-item list-group-item-action active" href="{% url 'superuser-dashboard' %}">
        <i class="bi bi-speedometer2"></i> Dashboard
    </a>
    <a class="list-group-item list-group-item-action" href="{% url 'halka-addition' %}">
        <i class="bi bi-people"></i> Halka Addition
    </a>
    <a class="list-group-item list-group-item-action" href="{% url 'candidate-application-list' %}">
        <i class="bi bi-check-circle"></i> Approve Candidates
    </a>
    <a class="list-group-item list-group-item-action" href="{% url 'set-polling-schedule' %}">
        <i class="bi bi-calendar-event"></i> Set Polling Schedule
    </a>
</div>
{% endblock %}
{% block winner_display %}
    <div class="winners-section">
        {% if polling_schedule %}
            {% if not polling_schedule.is_voting_open %}
                {% if current_time > polling_schedule.end_datetime.time %}
                <div class="container">
                    <p class="mt-3">Polling has ended. Here are the winners:</p>
                    <table class="table table-bordered">
                        <thead class="thead-light">
                            <tr>
                                <th>Halka</th>
                                <th>Winner</th>
                                <th>Total Votes</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for halka, winner_info in winners_by_halka.items %}
                                <tr>
                                    <td>{{ halka.name }}</td>
                                    <td>
                                        {% if winner_info %}
                                            {{ winner_info.candidate.username }}
                                        {% else %}
                                            No winner declared for this halka.
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if winner_info %}
                                            {{ winner_info.votes }}
                                        {% else %}
                                            N/A
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>                
                {% elif current_time >= polling_schedule.start_datetime.time and current_time <= polling_schedule.end_datetime.time %}
                    <p>Polling is in progress. Winners will be announced shortly.</p>
                {% else %}
                    <p>Polling has not started yet.</p>
                {% endif %}
            {% else %}
                <p>Polling is currently open.</p>
            {% endif %}
        {% else %}
            <p>Polling schedule information not available.</p>
        {% endif %}
    </div>
{% endblock %}



